Helper functions and extension methods.